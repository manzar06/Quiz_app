{% extends "base.html" %}

{% block title %}Dashboard - Quiz System{% endblock %}

{% block content %}
<div class="dashboard">
    <h2>Available Quizzes</h2>
    {% if quizzes %}
        <div class="quiz-grid">
            {% for quiz in quizzes %}
                <div class="quiz-card">
                    <h3>{{ quiz.title }}</h3>
                    <p class="quiz-description">{{ quiz.description or 'No description available' }}</p>
                    <div class="quiz-info">
                        <span class="info-item"><i class="fas fa-clock"></i> {{ quiz.time_limit // 60 }} minutes</span>
                        <span class="info-item"><i class="fas fa-question-circle"></i> {{ quiz.questions|length }} questions</span>
                    </div>
                    
                    {% if user_results.get(quiz.id) %}
                        <div class="quiz-history">
                            <h4><i class="fas fa-history"></i> Your Previous Attempts</h4>
                            <div class="history-list">
                                {% for result in user_results[quiz.id][:3] %}
                                    {% set percentage = (result.score / result.total_questions * 100) if result.total_questions > 0 else 0 %}
                                    <div class="history-item">
                                        <div class="history-score">
                                            <span class="score-value">{{ result.score }}/{{ result.total_questions }}</span>
                                            <span class="score-percentage">({{ "%.0f"|format(percentage) }}%)</span>
                                        </div>
                                        <div class="history-meta">
                                            <span class="history-date">{{ result.completed_at.strftime('%Y-%m-%d') }}</span>
                                            {% if percentage >= 80 %}
                                                <span class="performance-badge good"><i class="fas fa-check-circle"></i> Excellent</span>
                                            {% elif percentage >= 60 %}
                                                <span class="performance-badge good"><i class="fas fa-check"></i> Good</span>
                                            {% elif percentage >= 40 %}
                                                <span class="performance-badge average"><i class="fas fa-exclamation-circle"></i> Average</span>
                                            {% else %}
                                                <span class="performance-badge poor"><i class="fas fa-times-circle"></i> Needs Improvement</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% else %}
                        <div class="quiz-history">
                            <p class="no-history"><i class="fas fa-info-circle"></i> No previous attempts</p>
                        </div>
                    {% endif %}
                    
                    <a href="{{ url_for('quiz', quiz_id=quiz.id) }}" class="btn btn-primary"><i class="fas fa-play"></i> Start Quiz</a>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <p>No quizzes available at the moment.</p>
        </div>
    {% endif %}
</div>
{% endblock %}

